<!-- # Отчет по лабораторной работе №1 -->
#### «Национальный исследовательский университет ИТМО»
### Основы профессиональной деятельности
## Лабораторная работа 6
## Вариант 3101
### Хабнер Георгий, P3131
###  2023

## Задание
> По выданному преподавателем варианту разработать и исследовать работу комплекса программ обмена данными в режиме прерывания программы. Основная программа должна изменять содержимое заданной ячейки памяти (Х), которое должно быть представлено как знаковое число. Область допустимых значений изменения Х должна быть ограничена заданной функцией F(X) и конструктивными особенностями регистра данных ВУ (8-ми битное знаковое представление). Программа обработки прерывания должна выводить на ВУ модифицированное значение Х в соответствии с вариантом задания, а также игнорировать все необрабатываемые прерывания.
    1. Основная программа должна увеличивать на 2 содержимое X (ячейки памяти с адресом 03116) в цикле.
    2. Программа начинается с Обработчик прерывания должен по нажатию кнопки готовности ВУ-1 осуществлять вывод результата вычисления функции F(X)=2X-10 на данное ВУ, a по нажатию кнопки готовности ВУ-2 вычесть Х из утроенного содержимого РД данного ВУ, результат записать в Х.
    3. Если Х оказывается вне ОДЗ при выполнении любой операции по его изменению, то необходимо в Х записать минимальное по ОДЗ число.
   
## Код программы

ORG 0x0
V0: WORD $default, 0X180
V1: WORD $int1, 0X180
V2: WORD $int2, 0x180
V3: WORD $default, 0x180
V4: WORD $default, 0x180
V5: WORD $default, 0x180
V6: WORD $default, 0x180
V7: WORD $default, 0x180
default: IRET

ORG 0x031
X: WORD 0x043  
IO2: WORD 0x0
min:           WORD 0xFFC5 ; минимально принимаемое значение ОДЗ (-59)
max:            WORD 0x0044 ; максимально принимае значение ОДЗ (68)
START:          DI
                LD #0x9 ; Загрузка в аккумулятор MR (1000|0001=1001)
                OUT 3 ; Разрешение прерываний для 1 ВУ
                LD #0xA ; Загрузка в аккумулятор MR (1000|0010=1010)
                OUT 5 ; Разрешение прерываний для 2 ВУ

INCLP:          
                DI ; Запрет прерываний
                LD X
                INC    
                INC 
                CALL CHECK
                ST X
                EI
                BR INCLP

ORG 0x060
int1:           ; Обработка прерывания на ВУ-1
                HLT
                PUSH
                LD X
                ASL
                SUB #10
                OUT 2
                POP
                HLT
                IRET

ORG 0x070
          
int2:           ; Обработка прерывания на ВУ-2
                ; LD $X
                NOP
                PUSH
                CLA
                IN 4
                ST IO2
                ASL
                ADD IO2
                SUB X
                ST X
                NOP
                POP
                IRET

CHECK:          ; Проверка принадлежности X к ОДЗ
                CMP             min ; проверка x>min
                BMI             bad_ret
                CMP             max ; проверка x<max
                BPL             bad_ret

                RET
                bad_ret:        LD min ; загрузка в X min, если значение выходит из ОДЗ
                                RET

           
##ОДЗ программы

-128≤ 2X-10 ≤ 127
-118≤ 2X ≤ 137
-59≤ X ≤ 68
-59 = 1111.1111.1100.0101
68 = 0000.0000.0100.0100
X ϵ [FFC5; 0044]

###Методика проверки программы

Проверка обработки прерываний:
1. Загрузить текст программы в БЭВМ.
2. Заменить NOP по нужному адресу на HLT.
3. Запустить программу в режиме РАБОТА.
4. Установить «Готовность ВУ-1».
5. Жди, пока программа не остановится.
6.  Записать текущее значение X из памяти БЭВМ:
    1.Запомни, где сейчас находится счетчик команд.
    2. Введи 0x031 на клавиатуре
    3. Нажми "Ввод адреса".
    4. Нажми "Чтение".
    5. Запиши число, которое появится в регистре данных.
    6. Верни счетчик команд в исходное состояние.
7. Нажми «Продолжение» 2 раза.
8. Запиши результат обработки прерывания - число F(x), которое появится в DR контроллера ВУ-1.
9. Нажми «Продолжение».
10. Введи любое число на ВУ-2 и запиши его.
11. Подготовься к прерыванию на ВУ-2, нажав кнопку "Готовность ВУ-2".
12. Жди, пока программа не остановится.
13. Запиши число X (смотри пункт 6)
14. Нажми «Продолжение» 2 раза.
15. Запиши полученное значение X и сравни со значением (записанное число*3-записанный X) 



Проверка основной программы:
1. Загрузи программу в БЭВМ.
2. Запиши в переменную X максимально возможное значение (68).
3. Запусти программу в режиме останова.
4. Пройди нужное количество шагов программы и убедись, что когда X становится больше 68, то его значение сбрасывается до минимального значения, которое допустимо по ОДЗ.
5. Аналогично проверь, что при уменьшении X до значения меньше -59, его значение сбрасывается до минимального значения, которое допустимо по ОДЗ.


##ОП программы
•	X, min, max, IO2 – знаковое 16-ричное целое число;

